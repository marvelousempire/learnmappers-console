<div class="tab-content">
  <div class="sunday-container">
    <div class="sunday-card" style="margin-bottom:16px">
      <div style="display:flex;align-items:center;gap:12px;justify-content:space-between;flex-wrap:wrap">
        <div>
          <div style="font-size:12px;color:var(--muted)">Console</div>
          <h2 style="margin:6px 0 0">LearnMappers</h2>
          <div id="lmHomeTagline" style="color:var(--muted);margin-top:6px"></div>
        </div>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <a class="sunday-btn" href="#services">Go to Services</a>
          <a class="sunday-btn" href="#inventory">Open Inventory</a>
          <a class="sunday-btn" href="#docs">Docs</a>
          <a class="sunday-btn" href="#carts">Carts</a>
        </div>
      </div>
    </div>

    <div class="sunday-grid" style="grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px">
      <div class="sunday-card">
        <div style="font-size:12px;color:var(--muted)">Service categories</div>
        <div id="lmHomeCategories" style="font-size:28px;font-weight:800;margin-top:6px">—</div>
      </div>
      <div class="sunday-card">
        <div style="font-size:12px;color:var(--muted)">Total services</div>
        <div id="lmHomeServices" style="font-size:28px;font-weight:800;margin-top:6px">—</div>
      </div>
      <div class="sunday-card">
        <div style="font-size:12px;color:var(--muted)">Docs pages</div>
        <div id="lmHomeDocs" style="font-size:28px;font-weight:800;margin-top:6px">—</div>
      </div>
      <div class="sunday-card">
        <div style="font-size:12px;color:var(--muted)">Active cart items</div>
        <div id="lmHomeCartItems" style="font-size:28px;font-weight:800;margin-top:6px">—</div>
      </div>
    </div>

    <div class="sunday-card" style="margin-top:16px">
      <div style="font-weight:700;margin-bottom:8px">Quick links into existing LearnMappers content</div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="sunday-badge" href="/sites/learnmappers/content/pages/index.html" target="_blank" rel="noreferrer">Open legacy Home</a>
        <a class="sunday-badge" href="/sites/learnmappers/content/pages/service-menu.html" target="_blank" rel="noreferrer">Open legacy Service Menu</a>
        <a class="sunday-badge" href="/sites/learnmappers/content/pages/inventory.html" target="_blank" rel="noreferrer">Open legacy Inventory</a>
        <a class="sunday-badge" href="/sites/learnmappers/content/pages/docs-index.html" target="_blank" rel="noreferrer">Open legacy Docs Index</a>
      </div>
    </div>
  </div>
</div>

<script src="/learnmappers/js/lm-core.js"></script>
<script>
  async function initHomePage() {
    try {
      const cfg = await window.LearnMappersConsole.loadConfig();

      const tagline = cfg?.site?.tagline || cfg?.site?.description || '';
      const categories = cfg?.content?.services?.categories || [];
      const totalServices = categories.reduce((sum, cat) => sum + ((cat.services || []).length), 0);

      const docsSections = cfg?.documentation?.sections || [];
      const docsCount = docsSections.reduce((sum, sec) => sum + ((sec.pages || []).length), 0);

      const cartsState = window.LearnMappersConsole.loadCartsState();
      const activeCart = cartsState.carts.find(c => c.id === cartsState.activeCartId) || cartsState.carts[0];
      const cartItems = (activeCart?.items || []).length;

      document.getElementById('lmHomeTagline').textContent = tagline;
      document.getElementById('lmHomeCategories').textContent = String(categories.length);
      document.getElementById('lmHomeServices').textContent = String(totalServices);
      document.getElementById('lmHomeDocs').textContent = String(docsCount);
      document.getElementById('lmHomeCartItems').textContent = String(cartItems);
    } catch (e) {
      console.error(e);
      const el = document.getElementById('lmHomeTagline');
      if (el) el.textContent = 'Failed to load LearnMappers config.';
    }
  }
</script>
